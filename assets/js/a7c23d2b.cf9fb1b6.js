"use strict";(self.webpackChunkhumanoid_robotics_book=self.webpackChunkhumanoid_robotics_book||[]).push([[8785],{28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var i=r(96540);const s={},l=i.createContext(s);function o(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(l.Provider,{value:n},e.children)}},74032:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>t,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"ros2/rclpy-examples","title":"Python ROS 2 Client Library (rclpy)","description":"Using rclpy for Python-based ROS 2 development in humanoid robotics","source":"@site/docs/ros2/rclpy-examples.mdx","sourceDirName":"ros2","slug":"/ros2/rclpy-examples","permalink":"/humanoid-robotics-book/docs/ros2/rclpy-examples","draft":false,"unlisted":false,"editUrl":"https://github.com/ibrahimgem/humanoid-robotics-book/edit/main/docs/ros2/rclpy-examples.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Python ROS 2 Client Library (rclpy)","sidebar_position":4,"description":"Using rclpy for Python-based ROS 2 development in humanoid robotics"}}');var s=r(74848),l=r(28453);const o={title:"Python ROS 2 Client Library (rclpy)",sidebar_position:4,description:"Using rclpy for Python-based ROS 2 development in humanoid robotics"},a="Python ROS 2 Client Library (rclpy)",t={},c=[{value:"Introduction to rclpy",id:"introduction-to-rclpy",level:2},{value:"Basic Node Structure",id:"basic-node-structure",level:3},{value:"Publisher Example",id:"publisher-example",level:2},{value:"Subscriber Example",id:"subscriber-example",level:2},{value:"Service Example",id:"service-example",level:2},{value:"Action Example",id:"action-example",level:2},{value:"Parameter Handling",id:"parameter-handling",level:2},{value:"Quality of Service (QoS) Settings",id:"quality-of-service-qos-settings",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Related Topics",id:"related-topics",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"python-ros-2-client-library-rclpy",children:"Python ROS 2 Client Library (rclpy)"})}),"\n",(0,s.jsx)(n.admonition,{title:"Learning Objective",type:"info",children:(0,s.jsx)(n.p,{children:"After completing this chapter, you will be proficient in using rclpy to create Python-based ROS 2 applications. You will understand how to implement nodes, publishers, subscribers, services, and actions using Python."})}),"\n",(0,s.jsx)(n.p,{children:"The Robot Client Library for Python (rclpy) provides the Python API for ROS 2. It allows Python developers to create ROS 2 nodes, publish and subscribe to topics, and provide and use services."}),"\n",(0,s.jsx)(n.h2,{id:"introduction-to-rclpy",children:"Introduction to rclpy"}),"\n",(0,s.jsx)(n.p,{children:"rclpy is the Python client library for ROS 2. It provides a high-level interface to interact with the ROS 2 middleware and enables Python developers to create ROS 2 applications with familiar Python syntax."}),"\n",(0,s.jsx)(n.h3,{id:"basic-node-structure",children:"Basic Node Structure"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    node = Node('node_name')\n\n    # Node setup code here\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsx)(n.h2,{id:"publisher-example",children:"Publisher Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello World: %d' % self.i\n        self.publisher_.publish(msg)\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_publisher = MinimalPublisher()\n\n    try:\n        rclpy.spin(minimal_publisher)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        minimal_publisher.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsx)(n.h2,{id:"subscriber-example",children:"Subscriber Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_subscriber = MinimalSubscriber()\n\n    try:\n        rclpy.spin(minimal_subscriber)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        minimal_subscriber.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsx)(n.h2,{id:"service-example",children:"Service Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from example_interfaces.srv import AddTwoInts\nimport rclpy\nfrom rclpy.node import Node\n\nclass MinimalService(Node):\n    def __init__(self):\n        super().__init__('minimal_service')\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info('Incoming request\\na: %d b: %d' % (request.a, request.b))\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_service = MinimalService()\n\n    try:\n        rclpy.spin(minimal_service)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        minimal_service.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsx)(n.h2,{id:"action-example",children:"Action Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.action import ActionServer\nfrom rclpy.node import Node\n\nfrom example_interfaces.action import Fibonacci\n\nclass FibonacciActionServer(Node):\n\n    def __init__(self):\n        super().__init__('fibonacci_action_server')\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            'fibonacci',\n            self.execute_callback)\n\n    def execute_callback(self, goal_handle):\n        self.get_logger().info('Executing goal...')\n\n        feedback_msg = Fibonacci.Feedback()\n        feedback_msg.sequence = [0, 1]\n\n        for i in range(1, goal_handle.request.order):\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Goal canceled')\n                return Fibonacci.Result()\n\n            feedback_msg.sequence.append(\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1])\n\n            goal_handle.publish_feedback(feedback_msg)\n            time.sleep(1)\n\n        goal_handle.succeed()\n        result = Fibonacci.Result()\n        result.sequence = feedback_msg.sequence\n        return result\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    fibonacci_action_server = FibonacciActionServer()\n\n    try:\n        rclpy.spin(fibonacci_action_server)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        fibonacci_action_server.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsx)(n.h2,{id:"parameter-handling",children:"Parameter Handling"}),"\n",(0,s.jsx)(n.p,{children:"rclpy also provides parameter handling capabilities:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass ParameterNode(Node):\n    def __init__(self):\n        super().__init__('parameter_node')\n\n        # Declare parameters with default values\n        self.declare_parameter('param_name', 'default_value')\n        self.declare_parameter('number_param', 42)\n\n        # Get parameter values\n        param_value = self.get_parameter('param_name').value\n        number_value = self.get_parameter('number_param').value\n\n        self.get_logger().info(f'param_name: {param_value}')\n        self.get_logger().info(f'number_param: {number_value}')\n"})}),"\n",(0,s.jsx)(n.h2,{id:"quality-of-service-qos-settings",children:"Quality of Service (QoS) Settings"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, QoSDurabilityPolicy, QoSHistoryPolicy, QoSReliabilityPolicy\n\n# Create a QoS profile\nqos_profile = QoSProfile(\n    depth=10,\n    durability=QoSDurabilityPolicy.VOLATILE,\n    reliability=QoSReliabilityPolicy.BEST_EFFORT,\n    history=QoSHistoryPolicy.KEEP_LAST\n)\n\n# Use with publisher\npublisher = self.create_publisher(String, 'topic', qos_profile)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Always handle exceptions"}),": Use try-except blocks for graceful shutdown"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Properly clean up resources"}),": Destroy nodes and shutdown rclpy in finally blocks"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use appropriate logging"}),": Use node.get_logger() for consistent logging"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Parameter declaration"}),": Declare parameters at node initialization"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"QoS configuration"}),": Choose appropriate QoS settings based on application needs"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,s.jsxs)(n.p,{children:["For understanding the communication patterns these Python examples implement, see ",(0,s.jsx)(n.a,{href:"/docs/ros2/nodes-topics-services",children:"Nodes, Topics, and Services"}),". To learn about robot description formats, check out ",(0,s.jsx)(n.a,{href:"/docs/ros2/urdf",children:"URDF - Unified Robot Description Format"}),". For an overview of ROS 2 concepts, see ",(0,s.jsx)(n.a,{href:"/docs/ros2",children:"ROS 2 Overview"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:['ROS 2 Documentation. (2023). "rclpy API." [Online]. Available: ',(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/p/rclpy/",children:"https://docs.ros.org/en/humble/p/rclpy/"})]}),"\n",(0,s.jsx)(n.li,{children:'M\xf6rwald, T. (2021). "Programming Robots with ROS." O\'Reilly Media.'}),"\n",(0,s.jsx)(n.li,{children:'Patuzzo, J. (2022). "ROS 2 for Beginners." Robot Ignite Academy.'}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);