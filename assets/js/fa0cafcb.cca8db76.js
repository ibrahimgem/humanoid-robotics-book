"use strict";(self.webpackChunkhumanoid_robotics_book=self.webpackChunkhumanoid_robotics_book||[]).push([[8265],{3713:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"module-2-ros2-fundamentals/ros2-architecture-concepts","title":"Chapter 2.1 - ROS 2 Architecture and Concepts","description":"Nodes, Topics, Services, and Actions in ROS 2","source":"@site/docs/module-2-ros2-fundamentals/ros2-architecture-concepts.mdx","sourceDirName":"module-2-ros2-fundamentals","slug":"/module-2-ros2-fundamentals/ros2-architecture-concepts","permalink":"/humanoid-robotics-book/docs/module-2-ros2-fundamentals/ros2-architecture-concepts","draft":false,"unlisted":false,"editUrl":"https://github.com/ibrahimgem/humanoid-robotics-book/edit/main/docs/module-2-ros2-fundamentals/ros2-architecture-concepts.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"Chapter 2.1 - ROS 2 Architecture and Concepts","description":"Nodes, Topics, Services, and Actions in ROS 2"},"sidebar":"tutorialSidebar","previous":{"title":"Module 2 - ROS 2 Fundamentals for Humanoid Robotics","permalink":"/humanoid-robotics-book/docs/module-2-ros2-fundamentals/"},"next":{"title":"Chapter 2.2 - URDF and Robot Modeling","permalink":"/humanoid-robotics-book/docs/module-2-ros2-fundamentals/urdf-robot-modeling"}}');var r=s(74848),o=s(28453);const t={sidebar_position:6,title:"Chapter 2.1 - ROS 2 Architecture and Concepts",description:"Nodes, Topics, Services, and Actions in ROS 2"},a="Chapter 2.1: ROS 2 Architecture and Concepts",l={},c=[{value:"Goal",id:"goal",level:2},{value:"Learning Outcomes",id:"learning-outcomes",level:2},{value:"Introduction",id:"introduction",level:2},{value:"ROS 2 Architecture Overview",id:"ros-2-architecture-overview",level:2},{value:"Key Components",id:"key-components",level:3},{value:"Nodes",id:"nodes",level:2},{value:"Creating a Node",id:"creating-a-node",level:3},{value:"Node Names and Namespaces",id:"node-names-and-namespaces",level:3},{value:"Topics and Publishers/Subscribers",id:"topics-and-publisherssubscribers",level:2},{value:"Publisher Example",id:"publisher-example",level:3},{value:"Subscriber Example",id:"subscriber-example",level:3},{value:"Quality of Service (QoS) Settings",id:"quality-of-service-qos-settings",level:3},{value:"Services",id:"services",level:2},{value:"Service Server Example",id:"service-server-example",level:3},{value:"Service Client Example",id:"service-client-example",level:3},{value:"Actions",id:"actions",level:2},{value:"Action Server Example",id:"action-server-example",level:3},{value:"Parameters",id:"parameters",level:2},{value:"Launch Files",id:"launch-files",level:2},{value:"ROS 2 for Humanoid Robotics",id:"ros-2-for-humanoid-robotics",level:2},{value:"Example: Humanoid Robot Node Structure",id:"example-humanoid-robot-node-structure",level:3},{value:"Best Practices for ROS 2 Development",id:"best-practices-for-ros-2-development",level:2},{value:"Node Design",id:"node-design",level:3},{value:"Message Design",id:"message-design",level:3},{value:"System Architecture",id:"system-architecture",level:3},{value:"Summary",id:"summary",level:2},{value:"Exercises",id:"exercises",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"chapter-21-ros-2-architecture-and-concepts",children:"Chapter 2.1: ROS 2 Architecture and Concepts"})}),"\n",(0,r.jsx)(n.h2,{id:"goal",children:"Goal"}),"\n",(0,r.jsx)(n.p,{children:"Master the fundamental ROS 2 concepts essential for humanoid robotics development."}),"\n",(0,r.jsx)(n.h2,{id:"learning-outcomes",children:"Learning Outcomes"}),"\n",(0,r.jsx)(n.p,{children:"After completing this chapter, students will be able to design and implement basic ROS 2 nodes and communication patterns."}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"Robot Operating System 2 (ROS 2) is a flexible framework for writing robot software. It's a collection of tools, libraries, and conventions that aim to simplify the task of creating complex and robust robot behavior across a wide variety of robot platforms. Understanding ROS 2 architecture is fundamental for humanoid robotics development."}),"\n",(0,r.jsx)(n.h2,{id:"ros-2-architecture-overview",children:"ROS 2 Architecture Overview"}),"\n",(0,r.jsx)(n.p,{children:'ROS 2 uses a distributed architecture where processes (called "nodes") communicate with each other through messages. This architecture is built on top of DDS (Data Distribution Service), which provides the underlying communication infrastructure.'}),"\n",(0,r.jsx)(n.h3,{id:"key-components",children:"Key Components"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Nodes"}),": Processes that perform computation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Topics"}),": Named buses over which nodes exchange messages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Services"}),": Synchronous request/response communication"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Actions"}),": Asynchronous request/goal-based communication"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters"}),": Configuration values accessible to nodes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Launch files"}),": Configuration for starting multiple nodes"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"nodes",children:"Nodes"}),"\n",(0,r.jsx)(n.p,{children:"Nodes are the fundamental building blocks of ROS 2 applications. Each node is a separate process that performs a specific task and communicates with other nodes through messages."}),"\n",(0,r.jsx)(n.h3,{id:"creating-a-node",children:"Creating a Node"}),"\n",(0,r.jsxs)(n.p,{children:["In ROS 2, nodes are created by inheriting from the ",(0,r.jsx)(n.code,{children:"Node"})," class provided by the client library (rclpy for Python, rclcpp for C++)."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass MinimalNode(Node):\n    def __init__(self):\n        super().__init__('minimal_node')\n        self.get_logger().info('Hello from minimal node!')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MinimalNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"node-names-and-namespaces",children:"Node Names and Namespaces"}),"\n",(0,r.jsx)(n.p,{children:"Each node must have a unique name within the ROS graph. Nodes can also be organized using namespaces to avoid naming conflicts."}),"\n",(0,r.jsx)(n.h2,{id:"topics-and-publisherssubscribers",children:"Topics and Publishers/Subscribers"}),"\n",(0,r.jsx)(n.p,{children:"Topics enable asynchronous communication between nodes through a publish/subscribe pattern. Publishers send messages to a topic, and subscribers receive messages from that topic."}),"\n",(0,r.jsx)(n.h3,{id:"publisher-example",children:"Publisher Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello World: %d' % self.i\n        self.publisher.publish(msg)\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n        self.i += 1\n"})}),"\n",(0,r.jsx)(n.h3,{id:"subscriber-example",children:"Subscriber Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"quality-of-service-qos-settings",children:"Quality of Service (QoS) Settings"}),"\n",(0,r.jsx)(n.p,{children:"QoS settings control how messages are delivered between publishers and subscribers, affecting reliability, durability, and performance."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy\n\nqos_profile = QoSProfile(\n    depth=10,\n    reliability=ReliabilityPolicy.RELIABLE,\n    durability=DurabilityPolicy.VOLATILE\n)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"services",children:"Services"}),"\n",(0,r.jsx)(n.p,{children:"Services provide synchronous request/response communication between nodes. A service client sends a request to a service server, which processes the request and returns a response."}),"\n",(0,r.jsx)(n.h3,{id:"service-server-example",children:"Service Server Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass MinimalService(Node):\n    def __init__(self):\n        super().__init__('minimal_service')\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info('Incoming request\\na: %d b: %d' % (request.a, request.b))\n        return response\n"})}),"\n",(0,r.jsx)(n.h3,{id:"service-client-example",children:"Service Client Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass MinimalClient(Node):\n    def __init__(self):\n        super().__init__('minimal_client')\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('service not available, waiting again...')\n        self.req = AddTwoInts.Request()\n\n    def send_request(self, a, b):\n        self.req.a = a\n        self.req.b = b\n        self.future = self.cli.call_async(self.req)\n        rclpy.spin_until_future_complete(self, self.future)\n        return self.future.result()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"actions",children:"Actions"}),"\n",(0,r.jsx)(n.p,{children:"Actions are used for long-running tasks that may send feedback and can be canceled. They follow a goal-result-feedback pattern."}),"\n",(0,r.jsx)(n.h3,{id:"action-server-example",children:"Action Server Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.action import ActionServer\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci\n\nclass FibonacciActionServer(Node):\n    def __init__(self):\n        super().__init__('fibonacci_action_server')\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            'fibonacci',\n            self.execute_callback)\n\n    def execute_callback(self, goal_handle):\n        self.get_logger().info('Executing goal...')\n\n        feedback_msg = Fibonacci.Feedback()\n        feedback_msg.sequence = [0, 1]\n\n        for i in range(1, goal_handle.request.order):\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Goal canceled')\n                return Fibonacci.Result()\n\n            feedback_msg.sequence.append(\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1])\n\n            goal_handle.publish_feedback(feedback_msg)\n            time.sleep(1)\n\n        goal_handle.succeed()\n        result = Fibonacci.Result()\n        result.sequence = feedback_msg.sequence\n        self.get_logger().info('Returning result: {0}'.format(result.sequence))\n        return result\n"})}),"\n",(0,r.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(n.p,{children:"Parameters allow nodes to be configured at runtime. They can be set when launching nodes or changed during runtime."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Declare a parameter\nself.declare_parameter('param_name', 'default_value')\n\n# Get a parameter value\nparam_value = self.get_parameter('param_name').value\n\n# Set a parameter\nself.set_parameter('param_name', 'new_value')\n"})}),"\n",(0,r.jsx)(n.h2,{id:"launch-files",children:"Launch Files"}),"\n",(0,r.jsx)(n.p,{children:"Launch files allow you to start multiple nodes with a single command and configure their parameters."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n    return LaunchDescription([\n        Node(\n            package='my_package',\n            executable='my_node',\n            name='my_node_name',\n            parameters=[\n                {'param1': 'value1'},\n                {'param2': 123}\n            ]\n        )\n    ])\n"})}),"\n",(0,r.jsx)(n.h2,{id:"ros-2-for-humanoid-robotics",children:"ROS 2 for Humanoid Robotics"}),"\n",(0,r.jsx)(n.p,{children:"In humanoid robotics, ROS 2 provides the communication infrastructure that connects different subsystems:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Perception nodes"}),": Processing sensor data (cameras, LIDAR, IMU)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Control nodes"}),": Managing joint positions, balance, and locomotion"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Planning nodes"}),": Path planning and motion planning"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Behavior nodes"}),": High-level decision making and task execution"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-humanoid-robot-node-structure",children:"Example: Humanoid Robot Node Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Humanoid Robot System\n\u251c\u2500\u2500 Perception System\n\u2502   \u251c\u2500\u2500 Vision Processing\n\u2502   \u251c\u2500\u2500 IMU Processing\n\u2502   \u2514\u2500\u2500 Force/Torque Sensors\n\u251c\u2500\u2500 Control System\n\u2502   \u251c\u2500\u2500 Joint Control\n\u2502   \u251c\u2500\u2500 Balance Control\n\u2502   \u2514\u2500\u2500 Locomotion Control\n\u251c\u2500\u2500 Planning System\n\u2502   \u251c\u2500\u2500 Path Planning\n\u2502   \u251c\u2500\u2500 Motion Planning\n\u2502   \u2514\u2500\u2500 Task Planning\n\u2514\u2500\u2500 Interface System\n    \u251c\u2500\u2500 Human-Robot Interaction\n    \u2514\u2500\u2500 Remote Control\n"})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices-for-ros-2-development",children:"Best Practices for ROS 2 Development"}),"\n",(0,r.jsx)(n.h3,{id:"node-design",children:"Node Design"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Keep nodes focused on a single responsibility"}),"\n",(0,r.jsx)(n.li,{children:"Use appropriate QoS settings for different message types"}),"\n",(0,r.jsx)(n.li,{children:"Implement proper error handling and logging"}),"\n",(0,r.jsx)(n.li,{children:"Design for reusability and modularity"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"message-design",children:"Message Design"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use standard message types when possible"}),"\n",(0,r.jsx)(n.li,{children:"Design messages for efficiency (avoid large messages on fast topics)"}),"\n",(0,r.jsx)(n.li,{children:"Consider the frequency of message publication"}),"\n",(0,r.jsx)(n.li,{children:"Use appropriate data types for precision and efficiency"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"system-architecture",children:"System Architecture"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Plan the communication architecture before implementation"}),"\n",(0,r.jsx)(n.li,{children:"Use namespaces to organize related nodes"}),"\n",(0,r.jsx)(n.li,{children:"Consider network topology and bandwidth constraints"}),"\n",(0,r.jsx)(n.li,{children:"Implement proper testing and debugging strategies"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"ROS 2 provides the foundational communication architecture for humanoid robotics. Understanding nodes, topics, services, actions, and parameters is essential for building complex robotic systems. The distributed nature of ROS 2 enables the modular design of humanoid robot systems, where different components can be developed and tested independently."}),"\n",(0,r.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Create a simple publisher-subscriber pair that communicates joint position commands"}),"\n",(0,r.jsx)(n.li,{children:"Implement a service that calculates the forward kinematics for a simple arm"}),"\n",(0,r.jsx)(n.li,{children:"Design a launch file for a humanoid robot with perception, control, and planning nodes"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsx)(n.p,{children:'[1] M. Quigley et al., "ROS: an open-source Robot Operating System," ICRA Workshop on Open Source Software, 2009.'}),"\n",(0,r.jsxs)(n.p,{children:['[2] ROS 2 Documentation, "Concepts Overview," ',(0,r.jsx)(n.a,{href:"https://docs.ros.org/en/rolling/Concepts.html",children:"https://docs.ros.org/en/rolling/Concepts.html"})]}),"\n",(0,r.jsx)(n.p,{children:'[3] S. Chitta et al., "ROS Industrial: Advanced capabilities for manufacturing," ISER, 2012.'})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(96540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);